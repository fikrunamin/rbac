<%- include('../layout', { title: 'Proses Pembayaran' }) %>

<div class="container mt-4">
  <div class="row justify-content-center">
    <div class="col-md-8">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title mb-0">Proses Pembayaran Pesanan #<%= pesanan.id %></h3>
        </div>
        <div class="card-body">
          <% if (messages.error) { %>
            <div class="alert alert-danger">
              <%= messages.error %>
            </div>
          <% } %>

          <div class="mb-4">
            <h5>Detail Pesanan</h5>
            <p class="mb-1"><strong>Pelanggan:</strong> <%= pesanan.nama_pelanggan %></p>
            <p class="mb-1"><strong>Tanggal:</strong> <%= new Date(pesanan.tanggal_pesanan).toLocaleDateString('id-ID') %></p>
            <p class="mb-1"><strong>Total Pembayaran:</strong> Rp <%= total.toLocaleString('id-ID') %></p>
          </div>

          <form action="/pembayaran/<%= pesanan.id %>" method="POST">
            <div class="mb-3">
              <label for="metode" class="form-label">Metode Pembayaran</label>
              <select class="form-select" id="metode" name="metode" required>
                <option value="">Pilih Metode Pembayaran</option>
                <option value="transfer_bank">Transfer Bank</option>
                <option value="kartu_kredit">Kartu Kredit</option>
                <option value="e_wallet">E-Wallet</option>
                <option value="tunai">Tunai</option>
              </select>
            </div>

            <div class="mb-3">
              <label for="jumlah" class="form-label">Jumlah Pembayaran</label>
              <div class="input-group">
                <span class="input-group-text">Rp</span>
                <input type="number" class="form-control" id="jumlah" name="jumlah" value="<%= total %>" required readonly>
              </div>
            </div>

            <div class="mb-3">
              <label for="tanggal_pembayaran" class="form-label">Tanggal Pembayaran</label>
              <input type="date" class="form-control" id="tanggal_pembayaran" name="tanggal_pembayaran" value="<%= new Date().toISOString().split('T')[0] %>" required>
            </div>

            <div class="mb-3">
              <label for="status" class="form-label">Status Pembayaran</label>
              <select class="form-select" id="status" name="status" required>
                <option value="berhasil">Berhasil</option>
                <option value="gagal">Gagal</option>
              </select>
            </div>

            <div class="d-flex justify-content-between">
              <a href="/pesanan/<%= pesanan.id %>" class="btn btn-secondary">Kembali</a>
              <button type="submit" class="btn btn-primary">Proses Pembayaran</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>